<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Electrolize&display=swap" rel="stylesheet">
<link href="style.css" rel="stylesheet">
<title>Calculo Combustível</title>

</head>
<body>
<div class="fundo"></div>

<header>

<!-- Tela 1 -->
<div class="container" id="form-dados">
  <h2>Informe os dados</h2>
  <input type="number" id="distancia" placeholder="Distância até o trabalho (km)">
  <input type="number" id="consumo" placeholder="Consumo médio do veículo (km/L)">
  <input type="number" id="postos" placeholder="Quantos postos pesquisou?">
  <button onclick="mostrarPostos()">Próximo</button>
</div>

<!-- Tela 2 -->
<div class="container" id="form-postos" style="display:none;">
  <h2>Informe o preço nos postos</h2>
  <form id="postos-form"></form> <!-- Formulário onde serão criados os inputs para preços -->
  <button onclick="calcular()">Calcular</button> <!-- Botão para calcular os resultados -->
</div>

<!-- Tela 3 -->
<div class="container" id="resultado" style="display:none;">
  <h2>Resultados</h2>
  <div id="resultados"></div>  <!-- Área onde os resultados serão exibidos -->
</div>
</header>



<script>
// Função para mostrar inputs dos postos
function mostrarPostos() {
      // Lê os valores digitados pelo usuário e transforma em números
  const distancia = parseFloat(document.getElementById("distancia").value);
  const consumo = parseFloat(document.getElementById("consumo").value);
  const numPostos = parseInt(document.getElementById("postos").value);

    //VERIFICAÇÃO para evitar NaN ou valores inválidos
  if (isNaN(distancia) || isNaN(consumo) || isNaN(numPostos) ||
      distancia <= 0 || consumo <= 0 || numPostos <= 0) {
    // Se qualquer campo estiver errado, mostra alerta e para aqui
    alert("Por favor, preencha todos os campos corretamente.");
    return;  // interrompe a execução da função
  }

  //Se tudo válido, salva no sessionStorage para usar depois
  sessionStorage.setItem("distancia", distancia);
  sessionStorage.setItem("consumo", consumo);
  sessionStorage.setItem("numPostos", numPostos);

  // Esconde a primeira tela
  document.getElementById("form-dados").style.display = "none";
    // Mostra a tela para inserir os preços dos postos
  document.getElementById("form-postos").style.display = "block";

    // Cria dinamicamente os campos para os preços dos postos
  const postosForm = document.getElementById("postos-form");
  postosForm.innerHTML = ""; // limpa se já havia antes

    // Cria um input numérico para cada posto
  for (let i = 1; i <= numPostos; i++) {
    const input = document.createElement("input");
    input.type = "number";
    input.min = "0";
    input.step = "0.01";
    input.placeholder = `Preço no posto ${i} (R$)`;
    input.id = `preco${i}`;
    postosForm.appendChild(input);
  }
}

// Função para calcular resultados
function calcular() {
  const distancia = parseFloat(sessionStorage.getItem("distancia"));
  const consumo = parseFloat(sessionStorage.getItem("consumo"));
  const numPostos = parseInt(sessionStorage.getItem("numPostos"));

  let precoGasolina = [];  // array para armazenar os preços digitados
  let somaPrecos = 0; // soma dos preços para calcular média
  let menorPreco = Number.MAX_VALUE; // começa com o maior número possível para achar o menor

   // Percorre todos os postos para coletar os preços
  for (let i = 1; i <= numPostos; i++) {
    const preco = parseFloat(document.getElementById(`preco${i}`).value);
    if (isNaN(preco) || preco <= 0) {
      alert(`Por favor, preencha corretamente o preço do posto ${i}.`);
      return;
    }
    precoGasolina.push(preco); // adiciona ao array
    somaPrecos += preco; // acumula na soma
    if (preco < menorPreco) menorPreco = preco; // atualiza o menor preço
  }

    // Calcula litros necessários para a ida
  const consumoNecessarioLitros = distancia / consumo;
    // Calcula média dos preços
  const mediaPrecos = somaPrecos / numPostos;
    // Calcula gasto diário ida e volta considerando o menor preço
  const gastoDiario = 2 * (consumoNecessarioLitros * menorPreco);

  // Mostra resultados
  document.getElementById("form-postos").style.display = "none";
  document.getElementById("resultado").style.display = "block";

  const resultadosDiv = document.getElementById("resultados");
  resultadosDiv.innerHTML = `
    O consumo necessário é <strong>${consumoNecessarioLitros.toFixed(2)}</strong> litros.<br>
    O menor preço de combustível encontrado foi: <strong>R$ ${menorPreco.toFixed(2)}</strong><br>
    A média dos preços pesquisados foi: <strong>R$ ${mediaPrecos.toFixed(2)}</strong><br>
    O gasto diário com base no menor preço é: <strong>R$ ${gastoDiario.toFixed(2)}</strong>
  `;
}
</script>
<footer>
    <div class="rodope">
    <h3>Projeto FordEnter 2025. Sistema desenvolvido por Alexandro Jesus</h3>
    </div>
</footer>
</body>
</html>

